<!DOCTYPE html>

<head>

    <meta charset="utf-8">

    <meta name="viewport" content="width=device-width">

    <link href="{{ url_for('static', path='/style.css') }}" rel="stylesheet">

    <script src="https://unpkg.com/htmx.org@latest/dist/htmx.min.js"></script>

</head>

<script>
    function showForm1() {
        document.getElementById("hash_output").style.display = "block";
        document.getElementById("file_output").style.display = "none";
    }

    function showForm2() {
        document.getElementById("hash_output").style.display = "none";
        document.getElementById("file_output").style.display = "block";
    }
</script>

<script>

    document.addEventListener("htmx:responseError", function (event) {
        const response = event.detail.xhr.response;

        const error = JSON.parse(response);

        const fileComparison = `${error.detail}`;
        document.getElementById("hash_output").innerHTML = fileComparison;
    });

    document.addEventListener("htmx:configRequest", function (event) {
        if (event.detail.verb === "post") {
            document.getElementById("file_output").style.display = "block";
        }
        if (event.detail.verb === "get") {
            document.getElementById("hash_output").style.display = "block";
        }
    });

    document.addEventListener("htmx:afterRequest", function (event) {

        const response = event.detail.xhr.response;

        const jsonResponse = JSON.parse(response);

        // For hash comparison
        const hashes = jsonResponse.data[0].hashes;

        const fileType = jsonResponse.data[0].file_type;

        const fileExtension = jsonResponse.data[0].file_extension;

        const message = jsonResponse.message;

        const sourceIso = jsonResponse.data[0].source_iso_name;

        const opSystem = jsonResponse.data[0].operating_system;

        const name = jsonResponse.data[0].name;

        const baseFileType = jsonResponse.data[0].base_file_type;

        const fileComparison = `${message}<br><br><b>Name: </b>${name}<br><b>File Type: </b>${fileType}<br><b>File Extension: </b>
        ${fileExtension}<br><b>Source ISO: </b>${sourceIso}<br><b>Operating System: </b>${opSystem}<br><b>Base File Type: </b>${baseFileType} <br><br><b>MD5: </b> ${hashes.md5}<br><b>SHA1: </b>${hashes.sha1}<br><b>SHA256: </b>${hashes.sha256}<br><b>SHA512: </b>${hashes.sha512}`;
        document.getElementById("file_output").innerHTML = fileComparison;
    });

</script>

<body>

    <header>



        <div class="logo">



            <h1 id="blackoutline">



                <p>Darkmoon</p>



            </h1>



        </div>



        <nav>



            <ul>

                <button class="dropbtn"><a href="/webpages">Home</a></button>

                <div class="dropdown">



                    <button class="button button1">Tools</button>



                    <div class="dropdown-content">



                        <a href="/webpages/hash-lookup">Hash Lookup</a>



                        <a href="/webpages/upload">ISO Upload</a>



                    </div>



                </div>

                <button class="dropbtn"><a href="#">Credit</a></button>

            </ul>



        </nav>



    </header>

    <div style="padding:90px;">

        <h1></h1>

        <form id="hash_upload" hx-get="/metadata/hashSearch" hx-target="#hash_output" hx-trigger="submit"
            hx-swap="innerHTML">

            <h2> Hash and Hash Type </h2>

            <input id="fullHash" name="fullHash" required="required" type="text"
                placeholder="Ex: sha256:sdlkfjksldklsdjsdfklj" /><br>

            <input type="submit" value="Submit" hx-indicator="#hash_output" onclick="showForm1()" />

        </form>

        <div class="result_box" id="hash_output" style="display: none;">
            <div class="loading-spinner" style="padding:30px; object-position: center;"></div>
        </div>

        <h2></h2>

        <form id="file_upload" hx-trigger="submit" hx-post='/metadata/hashComparison' hx-target="#file_output"
            hx-swap="innerHTML" hx-encoding='multipart/form-data'>

            <h2> Upload File </h2>

            <input id="fileInput" type="file" required="required" name="fileInput"><br>

            <h2> ISO Key </h2>

            <input id="sourceIsoName" name="sourceIsoName" required="required" type="text"><br>

            <input type="submit" value="Upload" hx-indicator="#file_output" onclick="showForm2()">

        </form>

        <div class="result_box" id="file_output" style="display: none;">
            <div class="loading-spinner" style="padding:30px; object-position: center;"></div>
        </div>

    </div>

</body>



</html>
